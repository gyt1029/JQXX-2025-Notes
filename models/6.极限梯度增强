try:
    from xgboost import XGBClassifier
    use_xgboost = True
except ImportError:
    use_xgboost = False

def create_xgboost_model(preprocessor, scale_pos_weight=1):
    """创建XGBoost模型"""
    if not use_xgboost:
        print("警告: 未安装XGBoost库")
        return None
    
    model = Pipeline(steps=[
        ('preprocessor', preprocessor),
        ('classifier', XGBClassifier(random_state=42, eval_metric='logloss', 
                                   scale_pos_weight=scale_pos_weight))
    ])
    
    return model

def tune_xgboost(model, X_train, y_train):
    """XGBoost超参数调优"""
    if not use_xgboost:
        return model
    
    param_grid = {
        'classifier__n_estimators': [50, 100, 200],
        'classifier__max_depth': [3, 5, 7],
        'classifier__learning_rate': [0.01, 0.1, 0.2]
    }
    
    grid_search = GridSearchCV(model, param_grid, cv=5, scoring='roc_auc', n_jobs=-1)
    grid_search.fit(X_train, y_train)
    
    print(f"XGBoost最佳参数: {grid_search.best_params_}")
    return grid_search.best_estimator_
