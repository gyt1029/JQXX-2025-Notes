from sklearn.neural_network import MLPClassifier
from sklearn.pipeline import Pipeline

def create_dnn_model(preprocessor, hidden_layer_sizes=(100, 50)):
    """创建深度神经网络模型"""
    model = Pipeline(steps=[
        ('preprocessor', preprocessor),
        ('classifier', MLPClassifier(hidden_layer_sizes=hidden_layer_sizes, 
                                   max_iter=1000, random_state=42))
    ])
    
    return model

def tune_dnn(model, X_train, y_train):
    """DNN超参数调优"""
    param_grid = {
        'classifier__hidden_layer_sizes': [(50,), (100,), (100, 50), (50, 25)],
        'classifier__alpha': [0.0001, 0.001, 0.01],
        'classifier__learning_rate_init': [0.001, 0.01]
    }
    
    grid_search = GridSearchCV(model, param_grid, cv=5, scoring='roc_auc', n_jobs=-1)
    grid_search.fit(X_train, y_train)
    
    print(f"DNN最佳参数: {grid_search.best_params_}")
    return grid_search.best_estimator_
